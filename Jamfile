import feature : feature ;

install stage-test : udp_test : <location>. ;
install stage : utrack : <location>. ;

explicit stage-test ;
explicit stage ;

feature pcap : off on receive-only : composite propagated link-incompatible ;
feature.compose <pcap>on : <define>USE_PCAP ;
feature.compose <pcap>receive-only : <define>USE_PCAP <define>USE_SYSTEM_SEND_SOCKET ;

lib pcap : : <name>pcap : <search>/opt/local/lib : <include>/opt/local/include ;

exe utrack
	:
	main.cpp
	swarm.cpp
	announce_thread.cpp
	siphash24.c
	key_rotate.cpp
	receive_thread.cpp
	:
	<pcap>on:<library>pcap
	<pcap>receive-only:<library>pcap
	<pcap>on:<source>socket_pcap.cpp
	<pcap>receive-only:<source>socket_pcap.cpp
	<pcap>off:<source>socket_system.cpp
	;

exe udp_test : socket_pcap.cpp test_announce.cpp : <library>pcap ;

